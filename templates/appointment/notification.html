{% load static %}
{% load notifications_tags %}
<script
  src="{% static 'notifications/notify.js' %}"
  type="text/javascript"
></script>

<script>
function custom_fill_notification_list(data) {
  var menus = document.getElementsByClassName(notify_menu_class);
  if (menus) {
    var messages = data.unread_list
      .map(function(item) {
        var message = '';
        console.log(item)
        if (typeof item.verb !== 'undefined') {
          message = message + ' ' + item.verb +" on ";
        }
        if (typeof item.target !== 'undefined') {
          message = message + ' ' + item.target;
        }
        if (typeof item.timestamp !== 'undefined') {
            var datetime = new Date(item.timestamp)
            var year = datetime.getFullYear();
            var month = datetime.getMonth()
            var date = datetime.getDate()
            var hour = datetime.getHours()
            var minute = datetime.getMinutes()
            var second = datetime.getSeconds()
            var dateString = date + "-" +(month + 1) + "-" + year;
            var timeString = hour + ":" + minute + ":" + second

            console.log(datetime)
          message = message + ' ' + dateString + ' at ' + timeString;
        }
        var slug = item.slug.toString()
        var url_mask = "{% url 'notifications:mark_as_read' "
        url_mask = url_mask + slug;
        url_mask = url_mask + "%}"
        console.log(url_mask);
        return '<a href = ""><li>' + message + '</li></a>';
      })
      .join('');

    for (var i = 0; i < menus.length; i++) {
      menus[i].innerHTML = messages;
    }
  }
}
</script>

{% register_notify_callbacks callbacks='custom_fill_notification_list,fill_notification_badge' %}
<!-- transtaltion -->
{% load i18n %}
<!-- load notification  -->

{% notifications_unread as unread_count %}
{% if unread_count %}
    <p>You have <strong>{{ unread_count }}</strong> unread notifications.</p>
{% endif %}
<div class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
        <i class="fa fa-bell" style="font-size:30px;color:blue"> {% live_notify_badge badge_class="badge badge-secondary" %}
</i>

    </a>
    <ul class="dropdown-menu" id="notice-link">
        {% live_notify_list %}
    </ul>
</div>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

<script>
    $('.live_notify_list').css("list-style-type", 'none');
    $('.live_notify_list').css("padding", '15px');
    $('.live_notify_list').css("color", '#094c96');
    $('.live_notify_list .notification_list').css("padding", '10px');
</script>
